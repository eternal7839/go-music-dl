{{define "search_box"}}
<div class="search-box">
    <h1>ğŸµ <a href="https://github.com/guohuiyuan/go-music-dl" target="_blank" style="color: inherit; text-decoration: none;">music-dl</a></h1>
    <form action="{{.Root}}/search" method="get" id="search-form">
        <div class="search-type-switch">
            <label class="type-option">
                <input type="radio" name="type" value="song" 
                    {{ if or (eq .SearchType "song") (not .SearchType) }}checked{{ end }}
                    onchange="toggleSearchType(this.value)"> 
                <span>å•æ›²æœç´¢</span>
            </label>
            <label class="type-option">
                <input type="radio" name="type" value="playlist" 
                    {{ if eq .SearchType "playlist" }}checked{{ end }}
                    onchange="toggleSearchType(this.value)"> 
                <span>æ­Œå•æœç´¢</span>
            </label>
        </div>

        <div class="input-group">
            <input type="text" name="q" value="{{.Keyword}}" placeholder="æœç´¢æ­Œæ›²ã€æ­Œæ‰‹... æˆ–ç›´æ¥ç²˜è´´åˆ†äº«é“¾æ¥" required autocomplete="off">
            <button type="submit" class="search-btn"><i class="fa-solid fa-magnifying-glass"></i></button>
        </div>

        <div style="display: flex; gap: 15px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap;">
            <button type="button" class="btn-pill btn-pill-primary" onclick="goToRecommend()" 
                style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); border: none; box-shadow: 0 4px 15px rgba(255, 154, 158, 0.4); justify-content:center;">
                <i class="fa-solid fa-fire"></i> è·å–æ¯æ—¥æ¨èæ­Œå•
            </button>
            <button type="button" class="btn-pill btn-pill-fav" onclick="openCollectionManager()">
                <i class="fa-solid fa-folder-open"></i> æˆ‘çš„è‡ªåˆ¶æ­Œå•
            </button>
        </div>

        {{ if .Error }}
        <div class="error-msg">
            <i class="fa-solid fa-circle-exclamation"></i> {{ .Error }}
        </div>
        {{ end }}

        <div class="source-selector">
            <div class="source-header">
                <span class="source-title">æœç´¢æºè®¾ç½®</span>
                <div>
                    <button type="button" class="ctrl-btn" id="btn-all">å…¨é€‰</button>
                    <button type="button" class="ctrl-btn" id="btn-none">æ¸…ç©º</button>
                </div>
            </div>
            
            <div class="source-grid">
                {{ range $source := .AllSources }}
                <label>
                    <input type="checkbox" name="sources" value="{{ $source }}" class="source-checkbox"
                        data-supported="{{ index $.PlaylistSupported $source }}"
                        {{ if $.Selected }}
                            {{ range $.Selected }}{{ if eq . $source }}checked{{ end }}{{ end }}
                        {{ else }}
                            {{ range $.DefaultSources }}{{ if eq . $source }}checked{{ end }}{{ end }}
                        {{ end }}> 
                    <div class="source-card">
                        <div class="source-name">{{ $source }}</div>
                        <div class="source-desc">{{ index $.SourceDescriptions $source }}</div>
                    </div>
                </label>
                {{ end }}
            </div>
        </div>
    </form>
</div>
{{end}}
